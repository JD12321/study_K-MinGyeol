# merge(병합)
두 개의 브랜치를 하나로 모으는 과정을 말한다. fast-forward와 3-way 두 가지 방식이 존재한다.  
<br>

### fast-forward 방식
**병합 조건**
- 현재 브랜치 master가 병합할 대상 커밋의 직접적인 뿌리가 되는 경우에 사용 가능
- 간단히 말해, 두 브랜치가 일렬 상태인 경우
- 예를 들어, a라는 커밋에서 bugfix라는 브랜치를 생성한 뒤, 이후 main 브랜치에선 아무런 커밋을 생성하지 않고, bugfix 브랜치에서만 커밋을 생성한 경우  
<br>

**병합 방법**
```
$ git merge <branch> [--ff-only]
```

`<branch>`
- 병합할 브랜치명을 지정함

`--ff-only`
- fast-forward 방식을 사용하도록 강제함  
<br>

**병합 결과**  
충돌되는 부분이 없으므로 main 브랜치가 단순히 이동한다.  
<br>

### 3-way 방식
**병합 조건**
- 두 브랜치의 조상이 같은 경우
- 예를 들어, b 커밋에서 생성된 bugfix라는 브랜치가 있을 때, bugfix 브랜치에서도 커밋이 있고, 기존 main 브랜치에서도 b 커밋 이후의 커밋이 존재할 때

> 💡 fast-forward 방식으로 병합이 가능한 모든 상황은 3-way 방식으로 병합할 수 있다.  
<br>

**병합 방법**
```
$ git merge <branch> [-m <msg>] [--no-ff]
```
`<branch>`
- 병합할 브랜치명을 지정함

`-m <msg>`
- 커밋 메시지를 지정함
- 필수 옵션이 아니며 메시지를 적지 않을 경우 기본 메시지가 입력됨

`--no-ff`
- fast-forward 방식으로 병합이 가능한 상태일 때, 이 옵션을 사용하면 3-way 방식으로 병합을 진행한다  

> 💡 fast-forward 방식으로 병합이 가능함에도 불구하고 3-way 방식으로 병합할 수 있는 이유는 병합된 브랜치가 그대로 남기 때문에 이후 작업 확인 및 브랜치 관리면에서 유용하기 때문이다.  
<br>

**병합 결과**  
두개의 브랜치를 통합하는 과정이 포함된 커밋이 생성된다.  
<br>

### 옵션 --squash
merge에서 사용할 수 있는 또다른 옵션으로 `--squash`가 존재한다. 이 옵션은 영단어 squash의 정의인 '짓 뭉개다'와 역할이 비슷한데, 병합 과정에서 병합되는 브랜치의 이력을 남기지 않는다. 대신, 새로운 커밋에 상대 브랜치의 내용을 모두 합해서 새로운 커밋으로 병합한다.  

이러한 방식으로 병합을 진행하는 이유는 이력을 모두 날려버리기 때문에 굳이 불필요한 내역들이라면 보존하지 않고 뭉개버려서 향후 유지관리 시 보다 쾌적하게 하기 위함이다.  

단, 이때 주의할 점은 병합된 브랜치가 실제로 사라지는 것은 아니며, 병합 이후에도 여전히 남아있다.  
<br>

### 병합 충돌
브랜치를 병합하는 과정에서 동일한 파일의 내용이 각 브랜치마다 달라서 발생하는 일  
<br>
**충돌 기준**
- 파일 A가 양쪽에서 모두 수정 됨 → 충돌
- 파일 A는 브랜치 main에서만 수정됨, 파일 B는 브랜치 bugfix에서만 수정됨 → 충돌 X

충돌 발생 시 진행되던 병합이 일시 중단되고, 충돌을 해결해야 병합을 마무리할 수 있다.  
<br>
**충돌 해결 방법**  
충돌이 발생한 파일을 직접 수정한 후 저장해야 한다. 충돌이 발생하는 파일을 모두 수정하고 커밋하면 병합이 완료된다.  
<br>

### 병합 취소
```
$ git merge --abort
```